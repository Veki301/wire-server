Refactor effects around password resetting
